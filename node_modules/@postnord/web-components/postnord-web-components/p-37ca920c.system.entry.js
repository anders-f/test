var __extends=this&&this.__extends||function(){var e=function(t,i){e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i))e[i]=t[i]};return e(t,i)};return function(t,i){if(typeof i!=="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");e(t,i);function n(){this.constructor=t}t.prototype=i===null?Object.create(i):(n.prototype=i.prototype,new n)}}();var __awaiter=this&&this.__awaiter||function(e,t,i,n){function r(e){return e instanceof i?e:new i((function(t){t(e)}))}return new(i||(i=Promise))((function(i,o){function a(e){try{s(n.next(e))}catch(t){o(t)}}function l(e){try{s(n["throw"](e))}catch(t){o(t)}}function s(e){e.done?i(e.value):r(e.value).then(a,l)}s((n=n.apply(e,t||[])).next())}))};var __generator=this&&this.__generator||function(e,t){var i={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},n,r,o,a;return a={next:l(0),throw:l(1),return:l(2)},typeof Symbol==="function"&&(a[Symbol.iterator]=function(){return this}),a;function l(e){return function(t){return s([e,t])}}function s(a){if(n)throw new TypeError("Generator is already executing.");while(i)try{if(n=1,r&&(o=a[0]&2?r["return"]:a[0]?r["throw"]||((o=r["return"])&&o.call(r),0):r.next)&&!(o=o.call(r,a[1])).done)return o;if(r=0,o)a=[a[0]&2,o.value];switch(a[0]){case 0:case 1:o=a;break;case 4:i.label++;return{value:a[1],done:false};case 5:i.label++;r=a[1];a=[0];continue;case 7:a=i.ops.pop();i.trys.pop();continue;default:if(!(o=i.trys,o=o.length>0&&o[o.length-1])&&(a[0]===6||a[0]===2)){i=0;continue}if(a[0]===3&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(a[0]===6&&i.label<o[1]){i.label=o[1];o=a;break}if(o&&i.label<o[2]){i.label=o[2];i.ops.push(a);break}if(o[2])i.ops.pop();i.trys.pop();continue}a=t.call(e,i)}catch(l){a=[6,l];r=0}finally{n=o=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:true}}};var __spreadArray=this&&this.__spreadArray||function(e,t,i){if(i||arguments.length===2)for(var n=0,r=t.length,o;n<r;n++){if(o||!(n in t)){if(!o)o=Array.prototype.slice.call(t,0,n);o[n]=t[n]}}return e.concat(o||Array.prototype.slice.call(t))};System.register(["./p-9cbc7e95.system.js","./p-dd69298f.system.js"],(function(e){"use strict";var t,i,n,r,o,a;return{setters:[function(e){t=e.r;i=e.c;n=e.h;r=e.g},function(e){o=e.g;a=e.u}],execute:function(){var l=function(e){__extends(t,e);function t(t,i,n,r){if(n===void 0){n="INVALID"}if(r===void 0){r=null}var o=e.call(this,t)||this;o.name="PNFileUploadError";o.element=i;o.code=n;o.data=r;return o}return t}(Error);var s='pn-file-upload.hover .pn-file-upload-container .pn-dropzone-container{background-color:#e0f8ff}pn-file-upload.invalid .pn-file-upload-container .pn-dropzone-container,pn-file-upload.disabled .pn-file-upload-container .pn-dropzone-container{background-color:#d3cecb}pn-file-upload.invalid .pn-file-upload-container .pn-dropzone-container,pn-file-upload.invalid .pn-file-upload-container .pn-dropzone-container:after,pn-file-upload.disabled .pn-file-upload-container .pn-dropzone-container,pn-file-upload.disabled .pn-file-upload-container .pn-dropzone-container:after{background-image:-webkit-gradient(linear, left top, right top, color-stop(50%, #969087), color-stop(0%, transparent));background-image:linear-gradient(to right, #969087 50%, transparent 0%)}pn-file-upload.invalid .pn-file-upload-container .pn-dropzone-container .pn-dropzone-inner,pn-file-upload.invalid .pn-file-upload-container .pn-dropzone-container .pn-dropzone-inner:after,pn-file-upload.disabled .pn-file-upload-container .pn-dropzone-container .pn-dropzone-inner,pn-file-upload.disabled .pn-file-upload-container .pn-dropzone-container .pn-dropzone-inner:after{background-image:-webkit-gradient(linear, left top, left bottom, color-stop(50%, #969087), color-stop(0%, transparent));background-image:linear-gradient(to bottom, #969087 50%, transparent 0%)}pn-file-upload.invalid .pn-file-upload-container .pn-dropzone-container a,pn-file-upload.disabled .pn-file-upload-container .pn-dropzone-container a{cursor:default}pn-file-upload.invalid .pn-file-upload-container .pn-dropzone-container:hover,pn-file-upload.disabled .pn-file-upload-container .pn-dropzone-container:hover{background-color:#d3cecb}pn-file-upload.invalid .pn-file-upload-container .pn-dropzone-container .headline a,pn-file-upload.disabled .pn-file-upload-container .pn-dropzone-container .headline a{color:#5e554a}pn-file-upload .pn-file-upload-input{display:none}pn-file-upload .pn-file-upload-container .pn-dropzone-container{text-align:center;position:relative;background-image:-webkit-gradient(linear, left top, right top, color-stop(50%, #00a0d6), color-stop(0%, transparent));background-image:linear-gradient(to right, #00a0d6 50%, transparent 0%);background-position:top;background-size:16px 1px;background-repeat:repeat-x;background-color:#ffffff}pn-file-upload .pn-file-upload-container .pn-dropzone-container:after{content:" ";position:absolute;width:100%;height:1px;bottom:0;left:0;background-image:-webkit-gradient(linear, left top, right top, color-stop(50%, #00a0d6), color-stop(0%, transparent));background-image:linear-gradient(to right, #00a0d6 50%, transparent 0%);background-position:bottom;background-size:16px 1px;background-repeat:repeat-x}pn-file-upload .pn-file-upload-container .pn-dropzone-container:hover{background-color:#e0f8ff}pn-file-upload .pn-file-upload-container .pn-dropzone-container .pn-dropzone-inner{padding:25px 60px;position:relative;background-image:-webkit-gradient(linear, left top, left bottom, color-stop(50%, #00a0d6), color-stop(0%, transparent));background-image:linear-gradient(to bottom, #00a0d6 50%, transparent 0%);background-position:left;background-size:1px 16px;background-repeat:repeat-y}pn-file-upload .pn-file-upload-container .pn-dropzone-container .pn-dropzone-inner:after{content:" ";position:absolute;width:1px;height:100%;top:0;right:0;background-image:-webkit-gradient(linear, left top, left bottom, color-stop(50%, #00a0d6), color-stop(0%, transparent));background-image:linear-gradient(to bottom, #00a0d6 50%, transparent 0%);background-position:right;background-size:1px 16px;background-repeat:repeat-y}pn-file-upload .pn-file-upload-container .pn-dropzone-container .headline{color:#969087;font-size:16px;font-weight:300;line-height:20px;text-align:center;margin-bottom:8px}pn-file-upload .pn-file-upload-container .pn-dropzone-container .headline a{color:#005d92}pn-file-upload .pn-file-upload-container .pn-dropzone-container .description{color:#969087;font-size:12px;font-weight:300;line-height:16px;margin-bottom:0}pn-file-upload .files-list .files-list-item{display:-ms-flexbox;display:flex;-ms-flex-direction:row;flex-direction:row;-ms-flex-wrap:nowrap;flex-wrap:nowrap;-ms-flex-pack:justify;justify-content:space-between;-ms-flex-align:start;align-items:flex-start}pn-file-upload .files-list .files-list-item>pn-progress-bar{margin-right:10px;-ms-flex:1;flex:1}pn-file-upload .files-list .files-list-item>pn-icon{margin-top:34px;cursor:pointer}pn-file-upload .files-list .files-list-item-error{color:#5e554a;font-size:14px;font-weight:300;line-height:20px}';var p=e("pn_file_upload",function(){function e(e){t(this,e);this.filesAdded=i(this,"filesAdded",7);this.update=i(this,"update",7);this.fileuploaderror=i(this,"fileuploaderror",7);this.valid=i(this,"valid",7);this.uploadFile=i(this,"uploadFile",7);this.uploadCancelled=i(this,"uploadCancelled",7);this.uploadCompleted=i(this,"uploadCompleted",7);this.triggerElements=[];this.renders=0;this.maxSize="";this.limit=1;this.invalid=false;this.files=[];this.maxSizeInBytes=0}e.prototype.componentWillLoad=function(){this._initTriggerElements();this._setDefaultValues();this.initMaxBytes();if(this.disabled){this.hostElement.classList.add("disabled")}else{this.hostElement.classList.remove("disabled")}};e.prototype.componentWillUpdate=function(){if(this.invalid){this.hostElement.classList.add("invalid")}else{this.hostElement.classList.remove("invalid")}if(this.disabled){this.hostElement.classList.add("disabled")}else{this.hostElement.classList.remove("disabled")}};e.prototype.initMaxBytes=function(){this.maxSizeInBytes=o(this.maxSize)};e.prototype.componentDidLoad=function(){this.fileInputElement=this.hostElement.querySelector(".pn-file-upload-input");this.fileInputElement.addEventListener("change",this._onAddFile.bind(this))};e.prototype._setDefaultValues=function(){if(this.limit>1){this.multiple=true}};e.prototype._initTriggerElements=function(){var e=this;this.triggerElements=Array.from(this.hostElement.querySelectorAll(".pn-open-file-explorer"));this.triggerElements.forEach((function(t){if(t.dataset.canOpen!=="1"){t.addEventListener("click",e.openFileExplorer.bind(e));t.dataset.canOpen="1"}}))};e.prototype._addFilesFromFileList=function(e){if(this.disabled||this.invalid){return}var t=this;var i=Array.from(e);var n=[];if(this.multiple){i.forEach((function(e){n.push(t._addFile(e))}))}else{var r=i[0];if(this.limit===1){this.files=[];n.push(this._addFile(r))}else{n.push(this._addFile(r))}}Promise.all(n).then((function(){t.filesAdded.emit(t.files);t._isNotGreaterThanLimit();t._checkValidity();t._emitUpdateEvent();t.fileInputElement.value=""}))};e.prototype._onAddFile=function(){var e=this.fileInputElement.files;return this._addFilesFromFileList(e)};e.prototype._onDragOverFile=function(e){e.preventDefault();e.stopPropagation();this.hostElement.classList.add("hover")};e.prototype._onDragLeaveFile=function(e){e.preventDefault();e.stopPropagation();this.hostElement.classList.remove("hover")};e.prototype._onDropFile=function(e){e.preventDefault();e.stopPropagation();this.hostElement.classList.remove("hover");this._addFilesFromFileList(e.dataTransfer.files)};e.prototype._validateFileType=function(e){var t=this.accept?this.accept.split(","):[];if(t.length){var i=false;for(var n=0,r=t;n<r.length;n++){var o=r[n];var a=o.trim().toLowerCase();var s=/^\w+\/[a-z\.\-]+$/i;var p=e.filename.substr(e.filename.lastIndexOf(".")).toLowerCase();if(s.test(a)&&e.contentType===a){i=true;break}else if(p===a){i=true;break}}if(!i){var d=new l("Invalid file type.",this.hostElement,"INVALID_FILE_TYPE",e);this.invalid=true;this.fileuploaderror.emit(d);throw d}}};e.prototype._validateFileSize=function(e){if(this.maxSizeInBytes>0&&e.filesize>this.maxSizeInBytes){var t=new l("You can only add up to ".concat(this.maxSize,"."),this.hostElement,"MAX_FILE_SIZE",e);this.invalid=true;this.fileuploaderror.emit(t);throw t}};e.prototype._validateLimit=function(){if(this.limit&&this.files.length>this.limit){var e=new l("You can only add up to ".concat(this.limit," files."),this.hostElement,"MAX_LIMIT",this.files);this.invalid=true;this.fileuploaderror.emit(e);throw e}};e.prototype._isNotGreaterThanLimit=function(){try{this._validateLimit();return true}catch(e){return false}};e.prototype._checkValidity=function(){if(!this.invalid){this.valid.emit(this)}this._initTriggerElements();return!this.invalid};e.prototype._createBase64FromFile=function(e){return new Promise((function(t,i){var n=new FileReader;n.onload=function(){t(n.result)};n.onerror=function(e){i(e)};n.onabort=function(){i("ABORTED")};n.readAsDataURL(e)}))};e.prototype._addFile=function(e){var t=this;return this._createBase64FromFile(e).then((function(i){var n=i.split(",");var r=n[1];var o=n[0].split(":")[1].split(";")[0];var s=new XMLHttpRequest;var p={uuid:a(),filename:e.name,filesize:e.size,progress:0,status:"queue",base64:r,contentType:o,error:null,errorMessage:"",file:e,xhr:s};try{t._validateFileSize(p);t._validateFileType(p)}catch(d){p.error=d;p.progress=100;p.status="error"}p.xhrPromise=function(){return new Promise((function(e,i){s.responseType="json";s.addEventListener("progress",(function(e){if(e.lengthComputable){p.progress=e.loaded/e.total*100;t.updateFile(p)}else{p.progress=100;t.updateFile(p)}}));s.addEventListener("load",(function(t){e(t.target.response)}));s.addEventListener("error",(function(e){p.error=e;p.errorMessage="There was an error uploading your file, please try again";t.updateFile(p);var n=new l("There was an error uploading your file, please try again",t.hostElement,"UPLOAD_SERVER_ERROR",p);t.fileuploaderror.emit(n);i(e)}))}))};t.files=__spreadArray(__spreadArray([],t.files,true),[p],false);return p}))};e.prototype._removeFile=function(e,t){return function(i){i.preventDefault();t.removeFile(e)}};e.prototype._emitUpdateEvent=function(){this.update.emit({files:this.files,element:this})};e.prototype.openFileExplorer=function(e){e.preventDefault();if(!this.invalid&&!this.disabled){this.fileInputElement.click()}};e.prototype.startUpload=function(){return __awaiter(this,void 0,void 0,(function(){var e,t;return __generator(this,(function(i){e=this;if(!e.files.length){return[2]}e.files=e.files.map((function(t,i){if(t.status==="queue"){t.status="start";e.uploadFile.emit({file:t,index:i,uploader:e})}return t}));t=e.files.map((function(e){return e.xhrPromise().catch((function(){return}))}));Promise.all(t).then((function(t){var i=t.filter((function(e){return e}));e.uploadCompleted.emit(i)}));return[2]}))}))};e.prototype.clearUpload=function(){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(e){this.files=[];this.fileInputElement.value="";this.invalid=false;this.filesAdded.emit([]);return[2]}))}))};e.prototype.removeFile=function(e){return __awaiter(this,void 0,void 0,(function(){var t,i,n,r;return __generator(this,(function(o){t=true;i=[];for(n in this.files){r=this.files[n];if(!r.filename){continue}if(r.uuid!==e.uuid){try{this._validateFileSize(r);this._validateFileType(r);t=true}catch(a){t=false;r.error=a;r.progress=100;r.status="error"}i.push(r)}else if(r.status==="start"){r.xhr.abort();this.uploadCancelled.emit(r)}}this.filesAdded.emit(i);this.files=i;this.invalid=!t||!this._isNotGreaterThanLimit();this._checkValidity();this._emitUpdateEvent();return[2]}))}))};e.prototype.updateFile=function(e,t){if(t===void 0){t=null}return __awaiter(this,void 0,void 0,(function(){var i,n,r;return __generator(this,(function(o){i=this.files;if(t===null){for(n in i){r=i[n];if(r.uuid===e.uuid){t=n;break}}}if(i[t]){if(e.progress>=100){e.progress=100;e.status="completed"}else if(e.progress<0){e.status="start";e.progress=0}if(e.error){e.progress=100;e.status="error";e.errorMessage=e.errorMessage||"There was an error uploading your file, please try again"}i[t]=e}this.files=i;this._forceRender();return[2]}))}))};e.prototype._forceRender=function(){this.renders=this.renders+1};e.prototype.render=function(){var e=this;return n("div",{class:"pn-file-upload-container"},n("div",{class:"pn-dropzone-container"},n("div",{class:"pn-dropzone-inner"},n("div",{class:"pn-file-upload-dropzone",onDragOver:this._onDragOverFile.bind(this),onDragLeave:this._onDragLeaveFile.bind(this),onDrop:this._onDropFile.bind(this)},n("div",{class:"default-message-container"},this.disabled||this.invalid?n("pn-icon",{class:"pn-file-upload-dropzone-icon",symbol:"disabled",color:"grey-06-rock"}):n("pn-icon",{class:"pn-file-upload-dropzone-icon",symbol:"upload",color:"grey-06-rock"}),n("slot",null))))),n("section",{class:"files-list"},this.files.map((function(t){return n("div",{class:"files-list-item-container"},n("div",{class:"files-list-item"},n("pn-progress-bar",{label:t.filename,"show-spinner":e.showSpinner&&t.progress<100&&t.status==="start",progress:t.progress,color:t.status==="error"?"error":"default",size:"small",width:"100%"}),n("div",{class:"icon-button"}),n("pn-icon",{symbol:"minus-circle",color:"grey-05-battleship",onClick:e._removeFile(t,e)})),t.error?n("div",{class:"files-list-item-error"},t.errorMessage||t.error.message):null)}))),n("input",{type:"file",name:"pnFileUpload[]",class:"pn-file-upload-input",multiple:this.multiple,accept:this.accept}))};Object.defineProperty(e.prototype,"hostElement",{get:function(){return r(this)},enumerable:false,configurable:true});Object.defineProperty(e,"watchers",{get:function(){return{maxSize:["initMaxBytes"]}},enumerable:false,configurable:true});return e}());p.style=s}}}));