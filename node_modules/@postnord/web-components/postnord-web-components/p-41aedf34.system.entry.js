var __awaiter=this&&this.__awaiter||function(e,t,r,n){function i(e){return e instanceof r?e:new r((function(t){t(e)}))}return new(r||(r=Promise))((function(r,a){function o(e){try{l(n.next(e))}catch(t){a(t)}}function s(e){try{l(n["throw"](e))}catch(t){a(t)}}function l(e){e.done?r(e.value):i(e.value).then(o,s)}l((n=n.apply(e,t||[])).next())}))};var __generator=this&&this.__generator||function(e,t){var r={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},n,i,a,o;return o={next:s(0),throw:s(1),return:s(2)},typeof Symbol==="function"&&(o[Symbol.iterator]=function(){return this}),o;function s(e){return function(t){return l([e,t])}}function l(o){if(n)throw new TypeError("Generator is already executing.");while(r)try{if(n=1,i&&(a=o[0]&2?i["return"]:o[0]?i["throw"]||((a=i["return"])&&a.call(i),0):i.next)&&!(a=a.call(i,o[1])).done)return a;if(i=0,a)o=[o[0]&2,a.value];switch(o[0]){case 0:case 1:a=o;break;case 4:r.label++;return{value:o[1],done:false};case 5:r.label++;i=o[1];o=[0];continue;case 7:o=r.ops.pop();r.trys.pop();continue;default:if(!(a=r.trys,a=a.length>0&&a[a.length-1])&&(o[0]===6||o[0]===2)){r=0;continue}if(o[0]===3&&(!a||o[1]>a[0]&&o[1]<a[3])){r.label=o[1];break}if(o[0]===6&&r.label<a[1]){r.label=a[1];a=o;break}if(a&&r.label<a[2]){r.label=a[2];r.ops.push(o);break}if(a[2])r.ops.pop();r.trys.pop();continue}o=t.call(e,r)}catch(s){o=[6,s];i=0}finally{n=a=0}if(o[0]&5)throw o[1];return{value:o[0]?o[1]:void 0,done:true}}};System.register(["./p-9cbc7e95.system.js"],(function(e){"use strict";var t,r,n,i;return{setters:[function(e){t=e.r;r=e.c;n=e.h;i=e.a}],execute:function(){var a={CLOSEST_DELIVERY_DATE:{da:"Closest delivery date:",en:"Closest delivery date:",fi:"Closest delivery date:",no:"Closest delivery date:",sv:"Nästa utdelningsdag:"},NEXT_DELIVERY_DATE:{da:"Next delivery date:",en:"Next delivery date:",fi:"Next delivery date:",no:"Next delivery date:",sv:"Kommande utdelningsdag:"},ZIP_CODE:{da:"Zip code:",en:"Zip code:",fi:"Zip code:",no:"Zip code:",sv:"Postnummer:"},VALIDATION_ERROR_MESSAGE:{da:"Zip code not valid",en:"Zip code not valid",fi:"Zip code not valid",no:"Zip code not valid",sv:"Postnumret är inte giltigt"},SERVER_ERROR_MESSAGE:{da:"Could not find zip code",en:"Could not find zip code",fi:"Could not find zip code",no:"Could not find zip code",sv:"Kan inte hitta postnumret"},PLACEHOLDER_TEXT:{da:"Search for a zip code",en:"Search for a zip code",fi:"Search for a zip code",no:"Search for a zip code",sv:"Sök på ett postnummer"}};var o="pn-zipcode-search{display:block;color:#5e554a}pn-zipcode-search .search-results{margin-top:1em;padding:0.5em}pn-zipcode-search .search-results>h3,pn-zipcode-search .search-results h2{font-weight:normal}pn-zipcode-search .text-row{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center}pn-zipcode-search .text-row+.text-row{margin-top:1em}pn-zipcode-search .text-row>*+*{margin-left:0.25em}pn-zipcode-search .error-text{color:#a70707;padding:0.5em 1em}pn-zipcode-search pn-search-field{width:100%}@media screen and (max-width: 30em){pn-zipcode-search .text-row:nth-child(-n+2){-ms-flex-direction:column;flex-direction:column;-ms-flex-align:unset;align-items:unset}pn-zipcode-search .text-row:nth-child(-n+2) .delivery-date{margin-left:auto;margin-top:0.25em}}";var s=e("pn_zipcode_search",function(){function e(e){t(this,e);this.searchsuccessful=r(this,"searchsuccessful",7);this.marketwebLanguage="";this.language="sv";this.loading=false;this.error=false;this.errorMessage="";this.showResult=false;this.zipCodeSearchResult={delivery:"",upcoming:"",city:"",postalCode:""}}e.prototype.componentWillLoad=function(){var e=this;var t=window.pnTopbar;if(t){this.init()}else{window.addEventListener("topbarLoaded",(function(){e.init()}))}};e.prototype.init=function(){var e=this;var t=window.pnTopbar;if(t){this.language=t.language;t.onChangeLanguage=function(t){e.language=t}}};e.prototype.isEmpty=function(e){var t=!e;if(t){return true}var r=e.trim().length===0;if(r){return true}else{return false}};e.prototype.getTranslation=function(e,t){for(var r=0,n=Object.entries(a);r<n.length;r++){var i=n[r],o=i[0],s=i[1];if(o===e.toUpperCase()){var l=a[o].en;for(var c=0,u=Object.entries(s);c<u.length;c++){var d=u[c],h=d[0],p=d[1];if(h===t.toLowerCase()){if(this.isEmpty(p)){return l}else{return p}}}return l}}return e};e.prototype.handleSearch=function(e){var t=this.validateZipCode(e.detail);if(t.error){this.error=true;this.errorMessage="VALIDATION_ERROR_MESSAGE";return}this.zipCodeSearch(t.value)};e.prototype.zipCodeSearch=function(e){return __awaiter(this,void 0,void 0,(function(){var t=this;return __generator(this,(function(r){switch(r.label){case 0:this.loading=true;return[4,fetch("https://portal.postnord.com/api/sendoutarrival/closest?postalCode=".concat(e)).then((function(e){return e.json()})).then((function(e){t.error=false;t.loading=false;t.showResult=true;t.zipCodeSearchResult=e;t.searchsuccessful.emit(true)})).catch((function(){t.error=true;t.errorMessage="SERVER_ERROR_MESSAGE";t.loading=false;t.searchsuccessful.emit(false)}))];case 1:r.sent();return[2]}}))}))};e.prototype.validateZipCode=function(e){var t=e?e.replace(/[ -]/gi,""):"";var r=new RegExp(/\D+/);var n=r.test(t)||t.length!==5;return{error:n,value:t}};e.prototype.renderSearchResult=function(){if(!this.loading&&!this.error&&this.showResult){return n("div",{class:"search-results"},n("div",{class:"text-row"},n("h3",null,this.getTranslation("CLOSEST_DELIVERY_DATE",this.marketwebLanguage||this.language)," "),n("h2",{class:"delivery-date"},this.zipCodeSearchResult.delivery)),n("div",{class:"text-row"},n("h3",null,this.getTranslation("NEXT_DELIVERY_DATE",this.marketwebLanguage||this.language)," "),n("h2",{class:"delivery-date"},this.zipCodeSearchResult.upcoming)),n("div",{class:"text-row"},n("h3",null,this.getTranslation("ZIP_CODE",this.marketwebLanguage||this.language)),n("h2",null," ",this.zipCodeSearchResult.postalCode)),n("h3",null,this.zipCodeSearchResult.city))}};e.prototype.renderErrorMessage=function(){if(this.error&&!this.loading){return n("p",{class:"error-text pn-tiny"},this.getTranslation(this.errorMessage,this.marketwebLanguage||this.language))}};e.prototype.render=function(){var e=this;return n(i,null,n("pn-search-field",{loading:this.loading,button:"none",placeholder:this.getTranslation("PLACEHOLDER_TEXT",this.marketwebLanguage||this.language),onSearch:function(t){return e.handleSearch(t)}}),this.renderSearchResult(),this.renderErrorMessage())};return e}());s.style=o}}}));