import{r as e,c as t,h as i,a as s}from"./p-3aa90682.js";const o={CLOSEST_DELIVERY_DATE:{da:"Closest delivery date:",en:"Closest delivery date:",fi:"Closest delivery date:",no:"Closest delivery date:",sv:"Nästa utdelningsdag:"},NEXT_DELIVERY_DATE:{da:"Next delivery date:",en:"Next delivery date:",fi:"Next delivery date:",no:"Next delivery date:",sv:"Kommande utdelningsdag:"},ZIP_CODE:{da:"Zip code:",en:"Zip code:",fi:"Zip code:",no:"Zip code:",sv:"Postnummer:"},VALIDATION_ERROR_MESSAGE:{da:"Zip code not valid",en:"Zip code not valid",fi:"Zip code not valid",no:"Zip code not valid",sv:"Postnumret är inte giltigt"},SERVER_ERROR_MESSAGE:{da:"Could not find zip code",en:"Could not find zip code",fi:"Could not find zip code",no:"Could not find zip code",sv:"Kan inte hitta postnumret"},PLACEHOLDER_TEXT:{da:"Search for a zip code",en:"Search for a zip code",fi:"Search for a zip code",no:"Search for a zip code",sv:"Sök på ett postnummer"}},r=class{constructor(i){e(this,i),this.searchsuccessful=t(this,"searchsuccessful",7),this.marketwebLanguage="",this.language="sv",this.loading=!1,this.error=!1,this.errorMessage="",this.showResult=!1,this.zipCodeSearchResult={delivery:"",upcoming:"",city:"",postalCode:""}}componentWillLoad(){window.pnTopbar?this.init():window.addEventListener("topbarLoaded",(()=>{this.init()}))}init(){const e=window.pnTopbar;e&&(this.language=e.language,e.onChangeLanguage=e=>{this.language=e})}isEmpty(e){return!e||!(0!==e.trim().length)}getTranslation(e,t){for(const[i,s]of Object.entries(o))if(i===e.toUpperCase()){const e=o[i].en;for(const[i,o]of Object.entries(s))if(i===t.toLowerCase())return this.isEmpty(o)?e:o;return e}return e}handleSearch(e){const t=this.validateZipCode(e.detail);if(t.error)return this.error=!0,void(this.errorMessage="VALIDATION_ERROR_MESSAGE");this.zipCodeSearch(t.value)}async zipCodeSearch(e){this.loading=!0,await fetch(`https://portal.postnord.com/api/sendoutarrival/closest?postalCode=${e}`).then((e=>e.json())).then((e=>{this.error=!1,this.loading=!1,this.showResult=!0,this.zipCodeSearchResult=e,this.searchsuccessful.emit(!0)})).catch((()=>{this.error=!0,this.errorMessage="SERVER_ERROR_MESSAGE",this.loading=!1,this.searchsuccessful.emit(!1)}))}validateZipCode(e){const t=e?e.replace(/[ -]/gi,""):"";return{error:new RegExp(/\D+/).test(t)||5!==t.length,value:t}}renderSearchResult(){if(!this.loading&&!this.error&&this.showResult)return i("div",{class:"search-results"},i("div",{class:"text-row"},i("h3",null,this.getTranslation("CLOSEST_DELIVERY_DATE",this.marketwebLanguage||this.language)," "),i("h2",{class:"delivery-date"},this.zipCodeSearchResult.delivery)),i("div",{class:"text-row"},i("h3",null,this.getTranslation("NEXT_DELIVERY_DATE",this.marketwebLanguage||this.language)," "),i("h2",{class:"delivery-date"},this.zipCodeSearchResult.upcoming)),i("div",{class:"text-row"},i("h3",null,this.getTranslation("ZIP_CODE",this.marketwebLanguage||this.language)),i("h2",null," ",this.zipCodeSearchResult.postalCode)),i("h3",null,this.zipCodeSearchResult.city))}renderErrorMessage(){if(this.error&&!this.loading)return i("p",{class:"error-text pn-tiny"},this.getTranslation(this.errorMessage,this.marketwebLanguage||this.language))}render(){return i(s,null,i("pn-search-field",{loading:this.loading,button:"none",placeholder:this.getTranslation("PLACEHOLDER_TEXT",this.marketwebLanguage||this.language),onSearch:e=>this.handleSearch(e)}),this.renderSearchResult(),this.renderErrorMessage())}};r.style="pn-zipcode-search{display:block;color:#5e554a}pn-zipcode-search .search-results{margin-top:1em;padding:0.5em}pn-zipcode-search .search-results>h3,pn-zipcode-search .search-results h2{font-weight:normal}pn-zipcode-search .text-row{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center}pn-zipcode-search .text-row+.text-row{margin-top:1em}pn-zipcode-search .text-row>*+*{margin-left:0.25em}pn-zipcode-search .error-text{color:#a70707;padding:0.5em 1em}pn-zipcode-search pn-search-field{width:100%}@media screen and (max-width: 30em){pn-zipcode-search .text-row:nth-child(-n+2){-ms-flex-direction:column;flex-direction:column;-ms-flex-align:unset;align-items:unset}pn-zipcode-search .text-row:nth-child(-n+2) .delivery-date{margin-left:auto;margin-top:0.25em}}";export{r as pn_zipcode_search}