var __awaiter=this&&this.__awaiter||function(e,n,r,t){function a(e){return e instanceof r?e:new r((function(n){n(e)}))}return new(r||(r=Promise))((function(r,i){function s(e){try{c(t.next(e))}catch(n){i(n)}}function o(e){try{c(t["throw"](e))}catch(n){i(n)}}function c(e){e.done?r(e.value):a(e.value).then(s,o)}c((t=t.apply(e,n||[])).next())}))};var __generator=this&&this.__generator||function(e,n){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},t,a,i,s;return s={next:o(0),throw:o(1),return:o(2)},typeof Symbol==="function"&&(s[Symbol.iterator]=function(){return this}),s;function o(e){return function(n){return c([e,n])}}function c(s){if(t)throw new TypeError("Generator is already executing.");while(r)try{if(t=1,a&&(i=s[0]&2?a["return"]:s[0]?a["throw"]||((i=a["return"])&&i.call(a),0):a.next)&&!(i=i.call(a,s[1])).done)return i;if(a=0,i)s=[s[0]&2,i.value];switch(s[0]){case 0:case 1:i=s;break;case 4:r.label++;return{value:s[1],done:false};case 5:r.label++;a=s[1];s=[0];continue;case 7:s=r.ops.pop();r.trys.pop();continue;default:if(!(i=r.trys,i=i.length>0&&i[i.length-1])&&(s[0]===6||s[0]===2)){r=0;continue}if(s[0]===3&&(!i||s[1]>i[0]&&s[1]<i[3])){r.label=s[1];break}if(s[0]===6&&r.label<i[1]){r.label=i[1];i=s;break}if(i&&r.label<i[2]){r.label=i[2];r.ops.push(s);break}if(i[2])r.ops.pop();r.trys.pop();continue}s=n.call(e,r)}catch(o){s=[6,o];a=0}finally{t=i=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:true}}};import{r as registerInstance,h,a as Host}from"./index-970cd8af.js";var translations={SEARCH_BUTTON:{da:"Search",en:"Search",fi:"Search",no:"Search",sv:"Sök"},SEARCH_SUCCESS:{da:"Your OCR number is",en:"Your OCR number is",fi:"Your OCR number is",no:"Your OCR number is",sv:"Ditt OCR-nummer är"},ERROR_INVALID_LICENSE_NUMBER:{da:"Invalid license number",en:"Invalid license number",fi:"Invalid license number",no:"Invalid license number",sv:"Ogiltligt licensnummer"},ERROR_NO_RESULTS:{da:"The search did not generate any results",en:"The search did not generate any results",fi:"The search did not generate any results",no:"The search did not generate any results",sv:"Sökningen genererade inga träffar"},ERROR_REASON_HEADER:{da:"It may be due to:",en:"It may be due to:",fi:"It may be due to:",no:"It may be due to:",sv:"Det kan bero på:"},ERROR_REASON_ONE:{da:"We could not find that license number",en:"We could not find that license number",fi:"We could not find that license number",no:"We could not find that license number",sv:"Vi hittar inget sådant licensnummer"},ERROR_REASON_TWO:{da:"Check the information and try again.",en:"Check the information and try again.",fi:"Check the information and try again.",no:"Check the information and try again.",sv:"Kontrollera uppgifterna och försök igen."},PLACEHOLDER_TEXT:{da:"License number 6 digits",en:"License number 6 digits",fi:"License number 6 digits",no:"License number 6 digits",sv:"Licensnummer 6 tecken"}};var pnOcrSearchCss="pn-ocr-search .bold{font-weight:700}pn-ocr-search .search-results,pn-ocr-search .error-text-container{padding:1em 0.5em}pn-ocr-search .invalid-text-container{padding:0.5em 1em}pn-ocr-search .invalid-text-container .invalid-ocr{color:#a70707}";var PnOcrSearch=function(){function e(e){registerInstance(this,e);this.language="";this.loading=false;this.error=false;this.ocrNumber="";this.searchSuccess=false;this.invalidOcrNumber=false}e.prototype.getTranslation=function(e,n){var r,t;return((r=translations[e])===null||r===void 0?void 0:r[n])||((t=translations[e])===null||t===void 0?void 0:t.sv)||e};e.prototype.handleSearch=function(e){this.invalidOcrNumber=false;this.searchSuccess=false;this.error=false;var n=this.validateOcrNumber(e.detail);if(n.error){this.invalidOcrNumber=true;return}this.ocrNumberSearch(n.value)};e.prototype.ocrNumberSearch=function(e){return __awaiter(this,void 0,void 0,(function(){var n=this;return __generator(this,(function(r){switch(r.label){case 0:this.loading=true;return[4,fetch("https://portal.postnord.com/public-service/api/ocr?key=".concat(e)).then((function(e){return e.json()})).then((function(e){n.loading=false;n.ocrNumber=e.newOcr;n.searchSuccess=true})).catch((function(){n.error=true;n.loading=false;n.searchSuccess=false}))];case 1:r.sent();return[2]}}))}))};e.prototype.validateOcrNumber=function(e){var n=e?e.replace(/[ -]/gi,""):"";var r=new RegExp(/\D+/);var t=r.test(n)||n.length!==6;return{error:t,value:n}};e.prototype.renderSearchResult=function(){if(!this.loading&&!this.error&&this.searchSuccess){return h("div",{class:"search-results"},this.getTranslation("SEARCH_SUCCESS",this.language),": ",h("b",null,this.ocrNumber))}};e.prototype.renderErrorMessage=function(){if(this.invalidOcrNumber&&!this.loading){return h("div",{class:"invalid-text-container"},h("p",{class:"invalid-ocr"},this.getTranslation("ERROR_INVALID_LICENSE_NUMBER",this.language)))}if(this.error&&!this.loading){return h("div",{class:"error-text-container"},h("p",{class:"bold"},this.getTranslation("ERROR_NO_RESULTS",this.language)),h("p",{class:"bold"},this.getTranslation("ERROR_REASON_HEADER",this.language)),h("p",null,this.getTranslation("ERROR_REASON_ONE",this.language)),h("p",null,this.getTranslation("ERROR_REASON_TWO",this.language)))}};e.prototype.render=function(){var e=this;return h(Host,null,h("pn-search-field",{loading:this.loading,label:this.getTranslation("SEARCH_BUTTON",this.language),button:"",placeholder:this.getTranslation("PLACEHOLDER_TEXT",this.language),onSearch:function(n){return e.handleSearch(n)}}),this.renderSearchResult(),this.renderErrorMessage())};return e}();PnOcrSearch.style=pnOcrSearchCss;export{PnOcrSearch as pn_ocr_search};